## Sequential C++ Code

```
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        5.97
   256   256    64    64     yes        4.15
   512   512    64    64      no       19.38
   512   512    64    64     yes       19.58
  1024  1024    64    64      no       80.63
  1024  1024    64    64     yes       80.46
  2048  2048    64    64      no      321.20
  2048  2048    64    64     yes      326.80
  4096  2048    64    64      no      641.07
  4096  2048    64    64     yes      644.42

     m     n d_model   h    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256     256   8    64    64      no      319.44
   256   256     256   8    64    64     yes      111.70
   512   512     512   8    64    64      no      566.78
   512   512     512   8    64    64     yes      516.88
  1024  1024     512  16    64    64      no     5658.84
  1024  1024     512  16    64    64     yes     5738.89
  2048  2048    1024  16    64    64      no    26763.00
  2048  2048    1024  16    64    64     yes    32709.94
  4096  2048    1024  16    64    64      no    45510.01
  4096  2048    1024  16    64    64     yes    42311.46
```

## OpenMP with 12 threads

```
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        2.06
   256   256    64    64     yes        2.34
   512   512    64    64      no        9.81
   512   512    64    64     yes        7.47
  1024  1024    64    64      no       29.15
  1024  1024    64    64     yes       26.36
  2048  2048    64    64      no       90.20
  2048  2048    64    64     yes       92.62
  4096  2048    64    64      no      163.32
  4096  2048    64    64     yes      173.51

     m     n d_model   h    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256     256   8    64    64      no       56.85
   256   256     256   8    64    64     yes       50.09
   512   512     512   8    64    64      no      197.26
   512   512     512   8    64    64     yes      189.88
  1024  1024     512  16    64    64      no     1361.49
  1024  1024     512  16    64    64     yes     1270.19
  2048  2048    1024  16    64    64      no     5497.89
  2048  2048    1024  16    64    64     yes     5471.97
  4096  2048    1024  16    64    64      no     8802.56
  4096  2048    1024  16    64    64     yes     8551.59
```

## CUDA

```
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        0.34
   256   256    64    64     yes        0.36
   512   512    64    64      no        0.77
   512   512    64    64     yes        0.82
  1024  1024    64    64      no        1.91
  1024  1024    64    64     yes        2.09
  2048  2048    64    64      no        5.34
  2048  2048    64    64     yes        6.03
  4096  2048    64    64      no        9.75
  4096  2048    64    64     yes        8.99

     m     n d_model   h    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256     256   8    64    64      no       14.43
   256   256     256   8    64    64     yes       14.53
   512   512     512   8    64    64      no       24.06
   512   512     512   8    64    64     yes       24.33
  1024  1024     512  16    64    64      no      100.48
  1024  1024     512  16    64    64     yes      102.60
  2048  2048    1024  16    64    64      no      245.52
  2048  2048    1024  16    64    64     yes      253.25
  4096  2048    1024  16    64    64      no      375.66
  4096  2048    1024  16    64    64     yes      393.98
```

## CUDA single-head 4x4 block dim
```
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        0.34
   256   256    64    64     yes        0.36
   512   512    64    64      no        0.79
   512   512    64    64     yes        0.83
  1024  1024    64    64      no        2.00
  1024  1024    64    64     yes        2.14
  2048  2048    64    64      no        5.78
  2048  2048    64    64     yes        6.36
  4096  2048    64    64      no       10.70
  4096  2048    64    64     yes        9.75
```

## CUDA single-head 8x8 block dim
```
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        0.33
   256   256    64    64     yes        0.34
   512   512    64    64      no        0.74
   512   512    64    64     yes        0.76
  1024  1024    64    64      no        1.84
  1024  1024    64    64     yes        1.90
  2048  2048    64    64      no        5.18
  2048  2048    64    64     yes        5.46
  4096  2048    64    64      no        8.56
  4096  2048    64    64     yes        8.58
```

## CUDA single-head 16x16 block dim
```
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        0.33
   256   256    64    64     yes        0.34
   512   512    64    64      no        0.74
   512   512    64    64     yes        0.75
  1024  1024    64    64      no        1.79
  1024  1024    64    64     yes        1.84
  2048  2048    64    64      no        4.90
  2048  2048    64    64     yes        5.11
  4096  2048    64    64      no        7.43
  4096  2048    64    64     yes        8.02
```

## CUDA single-head 32x32 block dim
```
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        0.34
   256   256    64    64     yes        0.36
   512   512    64    64      no        0.77
   512   512    64    64     yes        0.82
  1024  1024    64    64      no        1.91
  1024  1024    64    64     yes        2.09
  2048  2048    64    64      no        5.34
  2048  2048    64    64     yes        6.03
  4096  2048    64    64      no        9.75
  4096  2048    64    64     yes        8.99
```


```
❯ OMP_NUM_THREADS=1 ./attention_openmp >/tmp/attention_openmp.txt
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        4.52
   256   256    64    64     yes        4.31
   512   512    64    64      no       19.65
   512   512    64    64     yes       19.91
  1024  1024    64    64      no       79.83
  1024  1024    64    64     yes       81.30
  2048  2048    64    64      no      323.10
  2048  2048    64    64     yes      329.76
  4096  2048    64    64      no      646.21
  4096  2048    64    64     yes      652.00

❮ OMP_NUM_THREADS=2 ./attention_openmp >/tmp/attention_openmp.txt
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        4.02
   256   256    64    64     yes        2.30
   512   512    64    64      no       10.13
   512   512    64    64     yes       10.24
  1024  1024    64    64      no       40.16
  1024  1024    64    64     yes       41.16
  2048  2048    64    64      no      163.65
  2048  2048    64    64     yes      166.53
  4096  2048    64    64      no      327.62
  4096  2048    64    64     yes      328.36

❯ OMP_NUM_THREADS=4 ./attention_openmp >/tmp/attention_openmp.txt
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        2.78
   256   256    64    64     yes        1.30
   512   512    64    64      no        5.18
   512   512    64    64     yes        6.28
  1024  1024    64    64      no       20.42
  1024  1024    64    64     yes       20.62
  2048  2048    64    64      no       83.20
  2048  2048    64    64     yes       84.90
  4096  2048    64    64      no      164.32
  4096  2048    64    64     yes      167.70


❯ OMP_NUM_THREADS=5 ./attention_openmp >/tmp/attention_openmp.txt
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        5.09
   256   256    64    64     yes        3.51
   512   512    64    64      no       10.98
   512   512    64    64     yes        7.33
  1024  1024    64    64      no       25.12
  1024  1024    64    64     yes       26.92
  2048  2048    64    64      no       97.89
  2048  2048    64    64     yes       99.64
  4096  2048    64    64      no      193.67
  4096  2048    64    64     yes      195.56

❮ OMP_NUM_THREADS=6 ./attention_openmp >/tmp/attention_openmp.txt
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        5.64
   256   256    64    64     yes        3.98
   512   512    64    64      no       10.83
   512   512    64    64     yes       10.36
  1024  1024    64    64      no       30.62
  1024  1024    64    64     yes       27.30
  2048  2048    64    64      no       89.59
  2048  2048    64    64     yes       94.65
  4096  2048    64    64      no      178.75
  4096  2048    64    64     yes      181.31


❯ OMP_NUM_THREADS=8 ./attention_openmp >/tmp/attention_openmp.txt
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        5.21
   256   256    64    64     yes        4.18
   512   512    64    64      no       10.84
   512   512    64    64     yes        7.96
  1024  1024    64    64      no       26.15
  1024  1024    64    64     yes       27.95
  2048  2048    64    64      no       90.78
  2048  2048    64    64     yes       93.70
  4096  2048    64    64      no      165.01
  4096  2048    64    64     yes      178.02

❯ OMP_NUM_THREADS=12 ./attention_openmp >/tmp/attention_openmp.txt
     m     n    dk    dv  causal    Time(ms)
--------------------------------------------------------
   256   256    64    64      no        5.02
   256   256    64    64     yes        3.59
   512   512    64    64      no        9.78
   512   512    64    64     yes        8.17
  1024  1024    64    64      no       25.05
  1024  1024    64    64     yes       25.04
  2048  2048    64    64      no       75.02
  2048  2048    64    64     yes       74.21
  4096  2048    64    64      no      143.60
  4096  2048    64    64     yes      144.21
speedy-attention on main +4 -7 [!?] via  v3.13.3 took 2s
❯
```
